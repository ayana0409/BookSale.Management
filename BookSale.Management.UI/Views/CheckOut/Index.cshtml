@using BookSale.Management.Application.DTOs.Books;
@using System.Globalization;
@using BookSale.Management.Application.DTOs.User;
@model UserAddressDTO;
@{
    var listAddress = ViewBag.AddressDTOs as IEnumerable<UserAddressDTO>;
}
<div class="row">
    <div class="col-7">
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h1 class="mb-0">Check out</h1>

                <button type="button" class="btn btn-info waves-effect waves-light" id="btn-change-address" style="float:left;">Change address</button>
            </div>
            <div class="card-body">
                <form asp-action="completecart" method="post">
                    <input type="hidden" name="Id" asp-for="Id" />
                    <input type="hidden" asp-for="OrderId" />
                    <div class="form-floating form-floating-outline mb-4">
                        <input type="text" class="form-control" asp-for="FullName" placeholder="Enter your name">
                        <label for="txtFullName">Full name</label>
                        <span asp-validation-for="FullName"></span>
                    </div>

                    <div class="form-floating form-floating-outline mb-4">
                        <input type="text" class="form-control" asp-for="PhoneNumber" placeholder="Enter your number phone">
                        <label for="txtPhone">Phone</label>
                        <span asp-validation-for="PhoneNumber"></span>
                    </div>
                    <div class="form-floating form-floating-outline mb-4">
                        <input type="email" class="form-control" asp-for="Email" placeholder="Enter your e mail">
                        <label for="txtEmail">Email</label>
                        <span asp-validation-for="Email"></span>
                    </div>
                    <div class="form-floating form-floating-outline mb-4">
                        <input type="text" class="form-control" asp-for="Address" placeholder="Enter your adress">
                        <label for="txtAdress">Address</label>
                        <span asp-validation-for="Address"></span>
                    </div>
                    <div class="form-floating form-floating-outline mb-4">
                        @* <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                            <input type="radio" class="btn-check" name="btnradio" asp-for="PaymentMethod" value="1">
                            <label class="btn btn-outline-primary waves-effect" for="crash">Crash</label>
                            <input type="radio" class="btn-check" name="btnradio" asp-for="PaymentMethod" value="2">
                            <label class="btn btn-outline-primary waves-effect" for="paypal">Paypal</label>
                        </div> *@
                        <div class="form-check">
                            <input class="form-check-input" type="radio" asp-for="PaymentMethod" value="1" id="flexRadioDefault1">
                            <label class="form-check-label" for="flexRadioDefault1">
                                Default radio
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio"asp-for="PaymentMethod" value="2" id="flexRadioDefault2" checked>
                            <label class="form-check-label" for="flexRadioDefault2">
                                Paypal
                            </label>
                        </div>
                    </div>
                    <div class="form-floating form-floating-outline mb-4">
                        <div id="paypal-button-container"></div>
                    </div>
                    <button type="submit" class="btn btn-success waves-effect waves-light" style="float:left;">Complete Purchase</button>
                </form>
            </div>
        </div>
    </div>
    <div class="col-5">
        <h3>Your cart</h3>
        <table class="table table-info">
            @{
                IEnumerable<BookCartDTO> books = new List<BookCartDTO>();

                if (ViewBag.Books is not null)
                {
                    books = ViewBag.Books as IEnumerable<BookCartDTO>;
                }
            }
            <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Title</th>
                    <th scope="col">Quantity</th>
                    <th scope="col">Price</th>
                </tr>
            </thead>
            <tbody>
                @{
                    int number = 0;
                    double total = 0;
                    foreach (var book in books)
                    {
                        number++;
                        <tr>
                            <th scope="row">@number</th>
                            <td>@book.Title</td>
                            <td>@book.Quantity</td>
                            <td>@book.Price.ToString("C", CultureInfo.GetCultureInfo("vi-VN"))</td>
                        </tr>
                        total += book.Quantity * book.Price;
                    }
                }

                @if (ViewBag.Books is null)
                {
                <td colspan="4">No data</td>
                }

            <tr>
                <td colspan="3"><b>Total:</b></td>
                <td colspan="1" id="txt-total-cart"><b>@total.ToString("C", CultureInfo.GetCultureInfo("vi-VN"))</b></td>
            </tr>

            </tbody>
        </table>
    </div>
</div>

@await Html.PartialAsync("_AddressModal.cshtml", listAddress)


@section Scripts {
    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
    <script src="https://www.paypal.com/sdk/js?client-id=AVdTVk2LMNabyrS5oasWNDVreLvwbTwvyH4GyeTeAGrr10BjB0VAgbUGjIEgHAraKexX6xtMz793bZYq" data-namespace="paypal_sdk"></script>
    <script src="~/js/components/checkout.js"></script>
}